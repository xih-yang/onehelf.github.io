"use strict";var kr={};window.requestIdleCallback=window.requestIdleCallback||function(e){var t=Date.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})}),1)},window.cancelIdleCallback=window.cancelIdleCallback||function(e){clearTimeout(e)},function(){var e,t="",n=function(e){var t,n=!(arguments.length>1&&arguments[1]!==undefined)||arguments[1],o=e/1e3,a=Math.floor(o/60/60/24),i=Math.floor(o/60/60-24*a),r=Math.floor(o/60-1440*a-60*i),c=Math.floor(o-86400*a-3600*i-60*r),s=a.toString(),l=i.toString(),d=r.toString(),u=c.toString();return n?(s&&1===s.length&&(s="0"+s),l&&1===l.length&&(l="0"+l),d&&1===d.length&&(d="0"+d),u&&1===u.length&&(u="0"+u),t=s+"天"+l+"小时"+d+"分"+u+"秒"):t=a<540?a<60?s+"天":Math.floor(a/30).toString()+"个月":Math.floor(a/365).toString()+"年",t},o=function(e,t){var n=0;return function(){var o=this,a=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(o,a)}),t||0)}},a=function(){!function(){for(var e=document.getElementsByClassName("kratos-entry-thumb-new-img"),t=kr.cover&&kr.cover.randomAmount||20,n=kr.cover&&kr.cover.baseUrl||"https://cdn.jsdelivr.net/npm/hexo-theme-kratos-rebirth@latest/source/images/thumb/",o=kr.cover&&kr.cover.filenameTemplate||"thumb_{no}.webp",a=new Array(t+1),i=function(){for(var e,n=5;n>0&&(e=Math.floor(Math.random()*t+1),a[e]);)n--;if(n<=0){e=-1;for(var o=1;o<=t;o++)if(!a[o]){e=o;break}if(-1===e){for(var i=1;i<=t;i++)a[i]=!1;e=Math.floor(Math.random()*t+1)}}return a[e]=!0,e},r=0,c=e.length;r<c;r++)if(!$(e[r]).attr("src")){var s=i(),l=o.replace("{no}",s.toString()),d=void 0;d=l.includes("//")?l:"/"===n.substring(n.length-1)?n+l:n+"/"+l,$(e[r]).attr("src",d)}}(),"undefined"!=typeof $.fancybox&&($.fancybox.defaults.hash=!1,$(".kratos-hentry").each((function(e){$(this).find("img").each((function(){if(!($(this).parent().hasClass("fancybox")||$(this).parent().hasClass("qrcode")||$(this).parent().is("a"))){var e=this.alt;e&&$(this).after('<span class="caption">'+e+"</span>"),$(this).wrap('<a rel="gallery" href="'+this.src+'" data-fancybox="gallery" data-caption="'+e+'"></a>')}}))})),$(".fancybox").fancybox()),e="\n\n-------------------------\n".concat(kr.copyrightNotice,"\n作者：").concat(document.querySelector("meta[name='author']").getAttribute("content"),"\n来源：").concat(document.title,"\n链接：").concat(window.location.href,"\n"),t=document.title,"undefined"!=typeof MathJax&&MathJax.Hub.Typeset(),document.querySelectorAll("figure.highlight").forEach((function(e,t){e.getElementsByTagName("table")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr")[0].getElementsByClassName("code")[0].setAttribute("id","code-".concat(t)),e.innerHTML+='<button class="copy" data-clipboard-target="#code-'.concat(t,'">\n                <i class="fa fa-copy"></i>&nbsp;复制\n            </button>')})),new ClipboardJS("button.copy").on("success",(function(e){var t=e.trigger.innerHTML;e.trigger.innerHTML='<i class="fa fa-check-circle"></i>&nbsp;成功~',setTimeout((function(){e.trigger.innerHTML=t}),3e3),e.clearSelection()})),function(){var e="undefined"!=typeof window,t=e&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),n=e&&"IntersectionObserver"in window,o=document.querySelector(".post-comments.lazy-load"),a=function(){window.loadCommentsEventHandler&&window.cancelIdleCallback(window.loadCommentsEventHandler),window.loadCommentsEventHandler=window.requestIdleCallback(load_comm),load_comm=null};if(e&&!t&&n&&null!==o){var i=new IntersectionObserver((function(e){e[0].isIntersecting&&(a(),i.disconnect())}),{threshold:0});i.observe(o)}else"undefined"!=typeof load_comm&&null!==load_comm&&a()}(),function(){if(kr.expire_day){var e=document.getElementById("expire-alert");if(e){var t=e.querySelector("time"),o=new Date(parseInt(t.getAttribute("datetime"))),a=Date.now()-o;a>24*kr.expire_day*3600*1e3&&(t.innerText=n(a,!1),e.classList.remove("hidden"))}}}(),function(){if(null!==document.getElementById("krw-toc")){var e=document.getElementById("krw-toc").getElementsByClassName("toc-item"),t=[];try{Array.from(e).forEach((function(e){var n=e.querySelector(".toc-link"),o=decodeURI(n.getAttribute("href"));if("#"!=o.substring(0,1))throw new Error("TOC 小标题链接无效，格式无限");var a=document.getElementById(o.substring(1));if(!a)throw new Error("TOC 小标题链接无效，未找到相关引用");a.setAttribute("data-toc-id",t.length),t.push({at:a,el:e})}))}catch(h){return console.log("错误：",h.message),void Array.from(e).forEach((function(e){e.classList.add("show")}))}var n=-1,a=function(e){if(n!==e){if(-1!==n){t[n].el.classList.remove("active"),t[n].el.classList.remove("show");for(var o=t[n].el;!o.classList.contains("toc");)o.classList.contains("toc-item")&&o.classList.remove("show"),o=o.parentNode}if(-1!==e){t[e].el.classList.add("active"),t[e].el.classList.add("show");for(var a=t[e].el;!a.classList.contains("toc");)a.classList.contains("toc-item")&&a.classList.add("show"),a=a.parentNode}n=e}};if("IntersectionObserver"in window){var i=o((function(e,t){t===window.scrollY?window.requestAnimationFrame((function(){a(e)})):i(e,window.scrollY)}),100),r=new IntersectionObserver((function(e){var t=null;e.forEach((function(e){var n=Number.parseInt(e.target.getAttribute("data-toc-id"),10);!e.isIntersecting&&e.boundingClientRect.top<=e.rootBounds.top?t=n:e.isIntersecting&&e.boundingClientRect.bottom<e.rootBounds.top+e.rootBounds.height/2&&1===e.intersectionRatio&&(t=n-1)})),null!==t&&i(t,window.scrollY)}),{rootMargin:"-62px 0px 0px 0px",threshold:1});t.forEach((function(e){r.observe(e.at)})),window.addEventListener("pjax:before",(function(){r.disconnect(),t.length=0}),{once:!0})}else{var c=function(){t.forEach((function(e){e.h=e.at.getBoundingClientRect().top+window.scrollY-61}))};c();var s=function(){var e;e=!Number.isInteger(n)||n<0||n>t.length-1?0:n;var o=window.scrollY;if(o>=t[e].h)if(o>=t[t.length-1].h)e=t.length-1;else for(;o>=t[e+1].h;)e++;else for(;o<t[e].h&&!(--e<0););return e},l=o((function(){window.requestAnimationFrame((function(){a(s())}))}),100),d=o((function(){c(),window.requestAnimationFrame((function(){a(s())}))}),100);window.addEventListener("resize",d),window.addEventListener("scroll",l),window.addEventListener("pjax:before",(function(){window.removeEventListener("resize",d),window.removeEventListener("scroll",l),t.length=0}),{once:!0})}var u=document.getElementsByClassName("toc-progress-bar")[0],f=document.querySelector(".kratos-post-content"),m=function(){if(f){var e=window.scrollY||document.documentElement.scrollTop,t=f.clientHeight,n=document.documentElement.clientHeight,o=f.offsetTop,a=t>n?t-n:document.documentElement.scrollHeight-n,i=Math.max(0,Math.min((e-o)/a,1)),r=Math.round(100*i);u.style.width=(100*i).toString()+"%",u.setAttribute("aria-valuenow",r)}};window.addEventListener("scroll",(function(){window.requestAnimationFrame(m)})),m()}}()},i=function(){var o,i;a(),kr.copyrightNotice&&(document.body.oncopy=function(t){var n=window.getSelection().toString();n.length>150&&(t.preventDefault(),t.clipboardData&&t.clipboardData.setData("text/plain",n+e))}),function(){if(kr.siteLeaveEvent){var e,n=$('[rel="icon"]').attr("href");document.addEventListener("visibilitychange",(function(){document.hidden?(document.title=kr.leaveTitle,kr.leaveLogo&&$('[rel="icon"]').attr("href",kr.leaveLogo),clearTimeout(e)):(document.title=kr.returnTitle+" "+t,kr.leaveLogo&&$('[rel="icon"]').attr("href",n),e=setTimeout((function(){document.title=t,e=0}),2e3))}))}}(),o=new Date(kr.createTime),i=document.getElementById("span_dt"),setInterval((function(){i.innerText=n(Date.now()-o)}),1e3),$(document).on("click",".donate",(function(){layer.open({type:1,area:["300px","370px"],title:kr.donateBtn,resize:!1,scrollbar:!1,content:'<div class="donate-box"><div class="meta-pay text-center"><strong>'+kr.scanNotice+'</strong></div><div class="qr-pay text-center"><img class="pay-img" id="alipay_qr" src="'+kr.qr_alipay+'"><img class="pay-img d-none" id="wechat_qr" src="'+kr.qr_wechat+'"></div><div class="choose-pay text-center mt-2"><input id="alipay" type="radio" name="pay-method" checked><label for="alipay" class="pay-button"><img src="/images/alipay.webp"></label><input id="wechatpay" type="radio" name="pay-method"><label for="wechatpay" class="pay-button"><img src="/images/wechat.webp"></label></div></div>'}),$(".choose-pay input[type='radio']").click((function(){var e=$(this).attr("id");"alipay"==e&&($(".qr-pay #alipay_qr").removeClass("d-none"),$(".qr-pay #wechat_qr").addClass("d-none")),"wechatpay"==e&&($(".qr-pay #alipay_qr").addClass("d-none"),$(".qr-pay #wechat_qr").removeClass("d-none"))}))})),function(){if(kr.topNavScrollToggle){var e=window.innerHeight,t=!1;window.addEventListener("wheel",(function(){window.requestAnimationFrame((function(){e<window.scrollY?t||(document.body.classList.add("nav-up"),t=!0):e>window.scrollY&&t&&(document.body.classList.remove("nav-up"),t=!1),e=window.scrollY}))}))}}()};window.addEventListener("pjax:complete",a),window.addEventListener("window:onload",(function(){var e,t,n,o,a;e=i,fetch(((null===(t=window.kr)||void 0===t?void 0:t.siteRoot)||"/")+"config/main.json").then((function(e){return e.json()})).then((function(e){kr=e})).then((function(){e()})),n=!1,o=function(){window.requestAnimationFrame((function(){window.scrollY>200?n||(document.body.classList.add("scroll-down"),n=!0):n&&(document.body.classList.remove("scroll-down"),n=!1)}))},$(".gotop-box").on("click",(function(e){return $("html, body").animate({scrollTop:$("html").offset().top},500),!1})),o(),window.addEventListener("scroll",o),(a=$("#kratos-menu-wrap").clone()).attr({id:"offcanvas-menu"}),a.find("> ul").attr({id:""}).addClass("ul-me"),$("#kratos-page").prepend(a),$(".js-kratos-nav-toggle").on("click",(function(){$(".nav-toggle").hasClass("toon")?($(".nav-toggle").removeClass("toon"),$("#offcanvas-menu").css("right","-240px")):($(".nav-toggle").addClass("toon"),$("#offcanvas-menu").css("right","0px"))})),$("#offcanvas-menu").css("height",$(window).height()),$("#offcanvas-menu").css("right","-240px"),$(window).resize((function(){var e=$(window);$("#offcanvas-menu").css("height",e.height()),e.width()>769&&$(".nav-toggle").hasClass("toon")&&($(".nav-toggle").removeClass("toon"),$("#offcanvas-menu").css("right","-240px"))})),$(document).click((function(e){var t=$("#offcanvas-menu,.js-kratos-nav-toggle");t.is(e.target)||0!==t.has(e.target).length||$(".nav-toggle").hasClass("toon")&&($(".nav-toggle").removeClass("toon"),$("#offcanvas-menu").css("right","-240px"))})),$(document).on("click",".xHeading",(function(e){$(this).next().slideToggle(300),$(this).parent(".xControl").hasClass("active")?$(this).parent(".xControl").removeClass("active"):$(this).parent(".xControl").addClass("active"),e.preventDefault()})),$(document).on("click",".share",(function(){$(".share-wrap").fadeToggle("slow")})),$(document).on("click","a[class=toc-link]",(function(){return $("html, body").animate({scrollTop:$(decodeURI($(this).attr("href"))).offset().top-60},500),!1}))}),{once:!0}),window.onload=function(){window.dispatchEvent(new Event("window:onload")),console.log("页面加载完毕！消耗了 %c"+Math.round(100*performance.now())/100+" ms","background:#282c34;color:#51aded;")}}();
//# sourceMappingURL=../maps/kratosr.min.js.map
